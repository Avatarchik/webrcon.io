# .htaccess

# SSL Cipher Suite can't be modified here because SSL termination is not done here.

# HSTS Strict Transport Security - Minimum ache age 18 weeks for preload
Header always set Strict-Transport-Security "max-age=10886400; includeSubDomains; preload"

# Rewrite Engine On
RewriteEngine On

# If both HTTP and www
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteCond %{HTTP_HOST} ^(?:www\.)?(.*)$ [NC]
RewriteRule (.*) https://%1%{REQUEST_URI} [L,R=307]

# If naked domain but HTTP
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule (.*) https://%1%{REQUEST_URI} [L,R=307]

# If HTTPS but www
RewriteCond %{HTTP:X-Forwarded-Proto} https
RewriteCond %{HTTP_HOST} ^(?:www\.)?(.*)$ [NC]
RewriteRule (.*) https://%1%{REQUEST_URI} [L,R=307]